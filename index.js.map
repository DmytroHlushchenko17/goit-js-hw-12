{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const searchForm = document.querySelector('.form');\nexport const galleryEl = document.querySelector('.js-gallery');\nexport const loadMoreBtn = document.querySelector('.js-load-more');\n\nexport function clearGallery() {\n  if (galleryEl) galleryEl.innerHTML = '';\n}\n\nexport const loaderEl = document.querySelector('.loader');\n\nexport const showLoader = () => loaderEl && loaderEl.classList.add('is-active');\nexport const hideLoader = () =>\n  loaderEl && loaderEl.classList.remove('is-active');\n\nconst simpleLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createGallery(images) {\n  if (!Array.isArray(images) || !galleryEl) {\n    clearGallery();\n    return;\n  }\n\n  const markup = images\n    .map(img => {\n      const {\n        largeImageURL = '#',\n        webformatURL = '',\n        tags = '',\n        likes = 0,\n        views = 0,\n        comments = 0,\n        downloads = 0,\n      } = img || {};\n\n      return `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link js-gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\"><span>Likes:</span> ${likes}</p>\n          <p class=\"info-item\"><span>Views:</span> ${views}</p>\n          <p class=\"info-item\"><span>Comments:</span> ${comments}</p>\n          <p class=\"info-item\"><span>Downloads:</span> ${downloads}</p>\n        </div>\n      </li>`;\n    })\n    .join('');\n\n  galleryEl.insertAdjacentHTML('beforeend', markup);\n  if (simpleLightbox && typeof simpleLightbox.refresh === 'function')\n    simpleLightbox.refresh();\n}\n\nexport function showLoadMoreButton() {\n  if (!loadMoreBtn) return;\n  loadMoreBtn.classList.remove('is-hidden');\n}\n\nexport function hideLoadMoreButton() {\n  if (!loadMoreBtn) return;\n  loadMoreBtn.classList.add('is-hidden');\n}\n","import axios from 'axios';\nimport { showLoader, hideLoader } from './render-functions.js';\n\nconst API_KEY = '53360478-1bf245edf032d22b013a2c514';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function getImagesByQuery(query, page = 1) {\n  if (!query) return null;\n\n  const pageNum = Math.max(1, Number(page) || 1);\n\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: pageNum,\n    per_page: 15,\n  };\n\n  showLoader();\n  try {\n    const { data } = await axios.get(BASE_URL, { params });\n    return data;\n  } finally {\n    hideLoader();\n  }\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getImagesByQuery } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  searchForm,\n  loadMoreBtn,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions.js';\n\nif (!searchForm) {\n  console.warn('Search form not found (.form)');\n} else {\n  searchForm.addEventListener('submit', onSearchFormSubmit);\n}\n\nif (loadMoreBtn) loadMoreBtn.addEventListener('click', onLoadMore);\n\nlet currentQuery = '';\nlet currentPage = 1;\nlet totalHits = 0;\nlet fetchedCount = 0;\n\nexport async function onSearchFormSubmit(event) {\n  event.preventDefault();\n\n  const form = event.currentTarget;\n  const input = form.elements['search-text'];\n  const query = ((input && input.value) || '').trim();\n\n  if (!query) {\n    iziToast.warning({ message: 'The input must not be empty' });\n    return;\n  }\n\n  currentQuery = query;\n  currentPage = 1;\n  totalHits = 0;\n  fetchedCount = 0;\n\n  clearGallery();\n  hideLoadMoreButton();\n\n  try {\n    const data = await getImagesByQuery(query, currentPage);\n\n    if (!data || !Array.isArray(data.hits) || data.hits.length === 0) {\n      clearGallery();\n      iziToast.info({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        color: 'red',\n        position: 'center',\n      });\n      return;\n    }\n\n    createGallery(data.hits);\n\n    totalHits = Number(data.totalHits) || 0;\n    fetchedCount += data.hits.length;\n\n    if (fetchedCount < totalHits) {\n      showLoadMoreButton();\n    } else {\n      hideLoadMoreButton();\n    }\n  } catch (err) {\n    clearGallery();\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      color: 'red',\n      position: 'bottomCenter',\n    });\n  }\n}\n\nasync function onLoadMore(event) {\n  if (!currentQuery) return;\n\n  if (loadMoreBtn) loadMoreBtn.disabled = true;\n\n  currentPage += 1;\n\n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage);\n\n    if (!data || !Array.isArray(data.hits) || data.hits.length === 0) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but there are no more images to load.\",\n        position: 'bottomCenter',\n      });\n      return;\n    }\n\n    createGallery(data.hits);\n\n    fetchedCount += data.hits.length;\n\n    try {\n      const firstCard = document.querySelector('.gallery .gallery-item');\n      if (firstCard) {\n        const { height: cardHeight } = firstCard.getBoundingClientRect();\n        window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' });\n      }\n    } catch (e) {}\n\n    if (fetchedCount >= (Number(totalHits) || 0)) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (err) {\n    console.error(err);\n    iziToast.error({\n      message: 'Error loading more images â€” please try again.',\n    });\n  } finally {\n    if (loadMoreBtn) loadMoreBtn.disabled = false;\n  }\n}\n"],"names":["searchForm","galleryEl","loadMoreBtn","clearGallery","loaderEl","showLoader","hideLoader","simpleLightbox","SimpleLightbox","createGallery","images","markup","img","largeImageURL","webformatURL","tags","likes","views","comments","downloads","showLoadMoreButton","hideLoadMoreButton","API_KEY","BASE_URL","getImagesByQuery","query","page","pageNum","params","data","axios","onSearchFormSubmit","onLoadMore","currentQuery","currentPage","totalHits","fetchedCount","event","input","iziToast","firstCard","cardHeight","err"],"mappings":"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"}