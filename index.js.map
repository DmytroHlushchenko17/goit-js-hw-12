{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '53360478-1bf245edf032d22b013a2c514';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport const fetchImages = async (query, page = 1) => {\n  if (!query) return null;\n\n  const pageNum = Math.max(1, Number(page) || 1);\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: pageNum,\n    per_page: 15,\n  };\n\n  try {\n    const response = await axios.get(BASE_URL, { params });\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const searchForm = document.querySelector('.form');\nexport const galleryEl = document.querySelector('.js-gallery');\nexport const loadMoreBtn = document.querySelector('.js-load-more');\n\nexport function clearGallery() {\n  if (!galleryEl) return;\n  galleryEl.innerHTML = '';\n}\n\nexport const loaderEl = document.querySelector('.loader');\n\nexport function showLoader() {\n  if (!loaderEl) return;\n  loaderEl.classList.add('is-active');\n}\n\nexport function hideLoader() {\n  if (!loaderEl) return;\n  loaderEl.classList.remove('is-active');\n}\n\nconst simpleLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createGallery(images) {\n  if (!Array.isArray(images) || !galleryEl) {\n    clearGallery();\n    return;\n  }\n\n  const markup = images\n    .map(img => {\n      const {\n        largeImageURL = '#',\n        webformatURL = '',\n        tags = '',\n        likes = 0,\n        views = 0,\n        comments = 0,\n        downloads = 0,\n      } = img || {};\n\n      return `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link js-gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\"><span>Likes:</span> ${likes}</p>\n          <p class=\"info-item\"><span>Views:</span> ${views}</p>\n          <p class=\"info-item\"><span>Comments:</span> ${comments}</p>\n          <p class=\"info-item\"><span>Downloads:</span> ${downloads}</p>\n        </div>\n      </li>`;\n    })\n    .join('');\n\n  galleryEl.insertAdjacentHTML('beforeend', markup);\n\n  if (simpleLightbox && typeof simpleLightbox.refresh === 'function') {\n    simpleLightbox.refresh();\n  }\n}\n\nexport function showLoadMoreButton() {\n  if (!loadMoreBtn) return;\n  loadMoreBtn.classList.remove('is-hidden');\n}\n\nexport function hideLoadMoreButton() {\n  if (!loadMoreBtn) return;\n  loadMoreBtn.classList.add('is-hidden');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { fetchImages } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  searchForm,\n  loadMoreBtn,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  showLoader,\n  hideLoader,\n} from './js/render-functions.js';\n\nlet currentQuery = '';\nlet currentPage = 1;\nlet totalHits = 0;\nlet fetchedCount = 0;\n\nexport async function onSearchFormSubmit(event) {\n  event.preventDefault();\n\n  const form = event.currentTarget;\n  const input = form.elements['search-text'];\n  const query = ((input && input.value) || '').trim();\n\n  if (!query) {\n    iziToast.warning({ message: 'The input must not be empty' });\n    return;\n  }\n\n  currentQuery = query;\n  currentPage = 1;\n  totalHits = 0;\n  fetchedCount = 0;\n\n  clearGallery();\n  hideLoadMoreButton();\n\n  showLoader();\n  try {\n    const data = await fetchImages(query, currentPage);\n\n    if (!data || !Array.isArray(data.hits) || data.hits.length === 0) {\n      clearGallery();\n      iziToast.info({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        color: 'red',\n        position: 'center',\n      });\n      return;\n    }\n\n    createGallery(data.hits);\n\n    totalHits = Number(data.totalHits) || 0;\n    fetchedCount += data.hits.length;\n\n    if (fetchedCount < totalHits) {\n      showLoadMoreButton();\n    } else {\n      hideLoadMoreButton();\n    }\n  } catch (err) {\n    clearGallery();\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      color: 'red',\n      position: 'bottomCenter',\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function onLoadMore(event) {\n  if (!currentQuery) return;\n\n  if (loadMoreBtn) loadMoreBtn.disabled = true;\n\n  currentPage += 1;\n\n  showLoader();\n  try {\n    const data = await fetchImages(currentQuery, currentPage);\n\n    if (!data || !Array.isArray(data.hits) || data.hits.length === 0) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but there are no more images to load.\",\n        position: 'bottomCenter',\n      });\n      return;\n    }\n\n    createGallery(data.hits);\n\n    fetchedCount += data.hits.length;\n\n    try {\n      const firstCard = document.querySelector('.gallery .gallery-item');\n      if (firstCard) {\n        const { height: cardHeight } = firstCard.getBoundingClientRect();\n        window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' });\n      }\n    } catch (e) {}\n\n    if (fetchedCount >= (Number(totalHits) || 0)) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (err) {\n    console.error(err);\n    iziToast.error({\n      message: 'Error loading more images â€” please try again.',\n    });\n  } finally {\n    if (loadMoreBtn) loadMoreBtn.disabled = false;\n    hideLoader();\n  }\n}\n\nif (!searchForm) {\n  console.warn('Search form not found (.form)');\n} else {\n  searchForm.addEventListener('submit', onSearchFormSubmit);\n}\n\nif (loadMoreBtn) loadMoreBtn.addEventListener('click', onLoadMore);\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","pageNum","params","axios","error","searchForm","galleryEl","loadMoreBtn","clearGallery","loaderEl","showLoader","hideLoader","simpleLightbox","SimpleLightbox","createGallery","images","markup","img","largeImageURL","webformatURL","tags","likes","views","comments","downloads","showLoadMoreButton","hideLoadMoreButton","currentQuery","currentPage","totalHits","fetchedCount","onSearchFormSubmit","event","input","iziToast","data","onLoadMore","firstCard","cardHeight","err"],"mappings":"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"}